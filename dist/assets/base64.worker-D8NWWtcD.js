(function(){"use strict";function f(n){const r=new Uint8Array(n),s=32768,e=[];for(let t=0;t<r.length;t+=s)e.push(String.fromCharCode(...r.subarray(t,t+s)));return btoa(e.join(""))}function c(n){const r=atob(n),s=new Uint8Array(r.length);for(let e=0;e<r.length;e++)s[e]=r.charCodeAt(e);return s.buffer}const o=self;o.onmessage=n=>{const r=n.data,s=Number(r?.id);if(Number.isFinite(s))try{if(r.type==="arrayBufferToBase64"){const t=f(r.arrayBuffer),a={id:s,ok:!0,base64:t};o.postMessage(a);return}if(r.type==="base64ToArrayBuffer"){const t=c(r.base64),a={id:s,ok:!0,arrayBuffer:t};o.postMessage(a,[t]);return}const e={id:s,ok:!1,error:`未知任务类型: ${r?.type}`};o.postMessage(e)}catch(e){const t=e instanceof Error?e.message:String(e),a={id:s,ok:!1,error:t};o.postMessage(a)}}})();
