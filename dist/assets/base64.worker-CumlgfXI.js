(function(){"use strict";function f(n){const e=new Uint8Array(n),t=32768,r=[];for(let s=0;s<e.length;s+=t)r.push(String.fromCharCode(...e.subarray(s,s+t)));return btoa(r.join(""))}function u(n){const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t.buffer}const o=self;o.onmessage=n=>{const e=n.data,t=Number(e?.id);if(Number.isFinite(t))try{if(e.type==="arrayBufferToBase64"){const s=f(e.arrayBuffer),a={id:t,ok:!0,base64:s};o.postMessage(a);return}if(e.type==="ping"){const s={id:t,ok:!0,pong:!0};o.postMessage(s);return}if(e.type==="base64ToArrayBuffer"){const s=u(e.base64),a={id:t,ok:!0,arrayBuffer:s};o.postMessage(a,[s]);return}const r={id:t,ok:!1,error:`未知任务类型: ${e?.type}`};o.postMessage(r)}catch(r){const s=r instanceof Error?r.message:String(r),a={id:t,ok:!1,error:s};o.postMessage(a)}}})();
